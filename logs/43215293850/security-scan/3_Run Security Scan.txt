2025-08-09T13:25:20.5640863Z ##[group]Run # Install security tools
2025-08-09T13:25:20.5641283Z [36;1m# Install security tools[0m
2025-08-09T13:25:20.5641536Z [36;1msudo apt-get update[0m
2025-08-09T13:25:20.5641775Z [36;1msudo apt-get install -y bandit[0m
2025-08-09T13:25:20.5642015Z [36;1m[0m
2025-08-09T13:25:20.5642279Z [36;1m# Scan for security issues in Python files (if any exist)[0m
2025-08-09T13:25:20.5642642Z [36;1mif find . -name "*.py" -type f | grep -q .; then[0m
2025-08-09T13:25:20.5642978Z [36;1m  echo "Found Python files, running bandit scan..."[0m
2025-08-09T13:25:20.5643332Z [36;1m  find . -name "*.py" -type f | xargs bandit -r || true[0m
2025-08-09T13:25:20.5643609Z [36;1melse[0m
2025-08-09T13:25:20.5643838Z [36;1m  echo "No Python files found, skipping bandit scan"[0m
2025-08-09T13:25:20.5644136Z [36;1mfi[0m
2025-08-09T13:25:20.5644315Z [36;1m[0m
2025-08-09T13:25:20.5644543Z [36;1m# Check for hardcoded secrets in shell and Python scripts[0m
2025-08-09T13:25:20.5644909Z [36;1mecho "Checking for potential hardcoded secrets..."[0m
2025-08-09T13:25:20.5645355Z [36;1mif grep -r -i "password\|secret\|key" --include="*.sh" --include="*.py" . | \[0m
2025-08-09T13:25:20.5645792Z [36;1m  grep -v "# " | grep -v "README" | grep -v "GITHUB_TOKEN"; then[0m
2025-08-09T13:25:20.5646195Z [36;1m  echo "⚠️  Found potential hardcoded secrets above - please review"[0m
2025-08-09T13:25:20.5646512Z [36;1melse[0m
2025-08-09T13:25:20.5646725Z [36;1m  echo "✅ No obvious hardcoded secrets found"[0m
2025-08-09T13:25:20.5646975Z [36;1mfi[0m
2025-08-09T13:25:20.5677985Z shell: /usr/bin/bash -e {0}
2025-08-09T13:25:20.5678254Z ##[endgroup]
2025-08-09T13:25:20.8054578Z Get:1 file:/etc/apt/apt-mirrors.txt Mirrorlist [144 B]
2025-08-09T13:25:20.8212966Z Get:6 https://packages.microsoft.com/repos/azure-cli jammy InRelease [3596 B]
2025-08-09T13:25:20.8360029Z Hit:2 http://azure.archive.ubuntu.com/ubuntu jammy InRelease
2025-08-09T13:25:20.8363920Z Get:7 https://packages.microsoft.com/ubuntu/22.04/prod jammy InRelease [3632 B]
2025-08-09T13:25:20.8609809Z Get:3 http://azure.archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]
2025-08-09T13:25:20.8656848Z Get:4 http://azure.archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]
2025-08-09T13:25:20.8673769Z Get:5 http://azure.archive.ubuntu.com/ubuntu jammy-security InRelease [129 kB]
2025-08-09T13:25:20.9426883Z Get:8 https://packages.microsoft.com/repos/azure-cli jammy/main amd64 Packages [2575 B]
2025-08-09T13:25:21.1712382Z Get:9 https://packages.microsoft.com/ubuntu/22.04/prod jammy/main arm64 Packages [75.0 kB]
2025-08-09T13:25:21.1766211Z Get:10 https://packages.microsoft.com/ubuntu/22.04/prod jammy/main amd64 Packages [239 kB]
2025-08-09T13:25:21.4047026Z Get:11 http://azure.archive.ubuntu.com/ubuntu jammy-security/main Translation-en [379 kB]
2025-08-09T13:25:29.2041710Z Fetched 1087 kB in 1s (1503 kB/s)
2025-08-09T13:25:30.0519368Z Reading package lists...
2025-08-09T13:25:30.1108689Z Reading package lists...
2025-08-09T13:25:30.2971322Z Building dependency tree...
2025-08-09T13:25:30.2982950Z Reading state information...
2025-08-09T13:25:30.4464137Z The following additional packages will be installed:
2025-08-09T13:25:30.4465073Z   python3-bandit python3-git python3-gitdb python3-pbr python3-smmap
2025-08-09T13:25:30.4465759Z   python3-stevedore
2025-08-09T13:25:30.4469523Z Suggested packages:
2025-08-09T13:25:30.4469877Z   python-git-doc python3-nose
2025-08-09T13:25:30.4823450Z The following NEW packages will be installed:
2025-08-09T13:25:30.4828963Z   bandit python3-bandit python3-git python3-gitdb python3-pbr python3-smmap
2025-08-09T13:25:30.4829879Z   python3-stevedore
2025-08-09T13:25:30.4983239Z 0 upgraded, 7 newly installed, 0 to remove and 16 not upgraded.
2025-08-09T13:25:30.4983830Z Need to get 356 kB of archives.
2025-08-09T13:25:30.4984721Z After this operation, 1915 kB of additional disk space will be used.
2025-08-09T13:25:30.4985245Z Get:1 file:/etc/apt/apt-mirrors.txt Mirrorlist [144 B]
2025-08-09T13:25:30.5336251Z Get:2 http://azure.archive.ubuntu.com/ubuntu jammy/universe amd64 python3-smmap all 5.0.0-1 [21.0 kB]
2025-08-09T13:25:30.5536190Z Get:3 http://azure.archive.ubuntu.com/ubuntu jammy/universe amd64 python3-gitdb all 4.0.9-1 [46.5 kB]
2025-08-09T13:25:30.5736812Z Get:4 http://azure.archive.ubuntu.com/ubuntu jammy/universe amd64 python3-git all 3.1.24-1 [130 kB]
2025-08-09T13:25:30.5962769Z Get:5 http://azure.archive.ubuntu.com/ubuntu jammy/main amd64 python3-pbr all 5.8.0-0ubuntu1 [66.5 kB]
2025-08-09T13:25:30.6169765Z Get:6 http://azure.archive.ubuntu.com/ubuntu jammy/main amd64 python3-stevedore all 1:3.5.0-0ubuntu1 [20.9 kB]
2025-08-09T13:25:30.6362229Z Get:7 http://azure.archive.ubuntu.com/ubuntu jammy/universe amd64 python3-bandit all 1.6.2-1 [66.6 kB]
2025-08-09T13:25:30.6568446Z Get:8 http://azure.archive.ubuntu.com/ubuntu jammy/universe amd64 bandit all 1.6.2-1 [4384 B]
2025-08-09T13:25:30.9522082Z Fetched 356 kB in 0s (2104 kB/s)
2025-08-09T13:25:31.0883876Z Selecting previously unselected package python3-smmap.
2025-08-09T13:25:31.2020171Z (Reading database ... 
2025-08-09T13:25:31.2020814Z (Reading database ... 5%
2025-08-09T13:25:31.2021155Z (Reading database ... 10%
2025-08-09T13:25:31.2021480Z (Reading database ... 15%
2025-08-09T13:25:31.2021792Z (Reading database ... 20%
2025-08-09T13:25:31.2022110Z (Reading database ... 25%
2025-08-09T13:25:31.2022416Z (Reading database ... 30%
2025-08-09T13:25:31.2023119Z (Reading database ... 35%
2025-08-09T13:25:31.2023434Z (Reading database ... 40%
2025-08-09T13:25:31.2023743Z (Reading database ... 45%
2025-08-09T13:25:31.2024060Z (Reading database ... 50%
2025-08-09T13:25:31.7470166Z (Reading database ... 55%
2025-08-09T13:25:32.0443584Z (Reading database ... 60%
2025-08-09T13:25:32.3971951Z (Reading database ... 65%
2025-08-09T13:25:32.9746959Z (Reading database ... 70%
2025-08-09T13:25:34.1026990Z (Reading database ... 75%
2025-08-09T13:25:34.7702221Z (Reading database ... 80%
2025-08-09T13:25:36.5247989Z (Reading database ... 85%
2025-08-09T13:25:37.6889247Z (Reading database ... 90%
2025-08-09T13:25:38.8952933Z (Reading database ... 95%
2025-08-09T13:25:38.8953474Z (Reading database ... 100%
2025-08-09T13:25:38.8954090Z (Reading database ... 267991 files and directories currently installed.)
2025-08-09T13:25:38.9008274Z Preparing to unpack .../0-python3-smmap_5.0.0-1_all.deb ...
2025-08-09T13:25:38.9024773Z Unpacking python3-smmap (5.0.0-1) ...
2025-08-09T13:25:38.9338779Z Selecting previously unselected package python3-gitdb.
2025-08-09T13:25:38.9499177Z Preparing to unpack .../1-python3-gitdb_4.0.9-1_all.deb ...
2025-08-09T13:25:38.9509939Z Unpacking python3-gitdb (4.0.9-1) ...
2025-08-09T13:25:39.0101210Z Selecting previously unselected package python3-git.
2025-08-09T13:25:39.0261888Z Preparing to unpack .../2-python3-git_3.1.24-1_all.deb ...
2025-08-09T13:25:39.0272206Z Unpacking python3-git (3.1.24-1) ...
2025-08-09T13:25:39.0752932Z Selecting previously unselected package python3-pbr.
2025-08-09T13:25:39.0914966Z Preparing to unpack .../3-python3-pbr_5.8.0-0ubuntu1_all.deb ...
2025-08-09T13:25:39.0927094Z Unpacking python3-pbr (5.8.0-0ubuntu1) ...
2025-08-09T13:25:39.1284359Z Selecting previously unselected package python3-stevedore.
2025-08-09T13:25:39.1444922Z Preparing to unpack .../4-python3-stevedore_1%3a3.5.0-0ubuntu1_all.deb ...
2025-08-09T13:25:39.1455370Z Unpacking python3-stevedore (1:3.5.0-0ubuntu1) ...
2025-08-09T13:25:39.1732519Z Selecting previously unselected package python3-bandit.
2025-08-09T13:25:39.1893607Z Preparing to unpack .../5-python3-bandit_1.6.2-1_all.deb ...
2025-08-09T13:25:39.1904346Z Unpacking python3-bandit (1.6.2-1) ...
2025-08-09T13:25:39.2226080Z Selecting previously unselected package bandit.
2025-08-09T13:25:39.2387139Z Preparing to unpack .../6-bandit_1.6.2-1_all.deb ...
2025-08-09T13:25:39.2399325Z Unpacking bandit (1.6.2-1) ...
2025-08-09T13:25:39.3089580Z Setting up python3-pbr (5.8.0-0ubuntu1) ...
2025-08-09T13:25:39.4677477Z Setting up python3-stevedore (1:3.5.0-0ubuntu1) ...
2025-08-09T13:25:39.5855770Z Setting up python3-smmap (5.0.0-1) ...
2025-08-09T13:25:39.6943477Z Setting up python3-gitdb (4.0.9-1) ...
2025-08-09T13:25:39.8165577Z Setting up python3-git (3.1.24-1) ...
2025-08-09T13:25:39.9809025Z Setting up python3-bandit (1.6.2-1) ...
2025-08-09T13:25:40.1159362Z Setting up bandit (1.6.2-1) ...
2025-08-09T13:25:40.1207658Z Processing triggers for man-db (2.10.2-1) ...
2025-08-09T13:25:42.1780732Z NEEDRESTART-VER: 3.5
2025-08-09T13:25:42.8459554Z NEEDRESTART-KCUR: 6.8.0-1031-azure
2025-08-09T13:25:42.8460071Z NEEDRESTART-KEXP: 6.8.0-1031-azure
2025-08-09T13:25:42.8460450Z NEEDRESTART-KSTA: 1
2025-08-09T13:25:42.8461017Z NEEDRESTART-SVC: hosted-compute-agent.service
2025-08-09T13:25:44.1533552Z No Python files found, skipping bandit scan
2025-08-09T13:25:44.1534165Z Checking for potential hardcoded secrets...
2025-08-09T13:25:44.1574578Z ./ainux-builder.sh:    curl -fsSL https://repo.radeon.com/rocm/rocm.gpg.key | apt-key add -
2025-08-09T13:25:44.1575448Z ./ainux-builder.sh:CLUSTER_SECRET_KEY=/etc/cluster/cluster.key
2025-08-09T13:25:44.1576119Z ./ainux-builder.sh:    if [[ ! -f /etc/cluster/cluster.key ]]; then
2025-08-09T13:25:44.1576988Z ./ainux-builder.sh:        ssh-keygen -t ed25519 -f /etc/cluster/cluster.key -N "" -C "ainux-cluster-$(date +%s)"
2025-08-09T13:25:44.1577835Z ./ainux-builder.sh:        chmod 600 /etc/cluster/cluster.key*
2025-08-09T13:25:44.1578451Z ./ainux-builder.sh:        log_cluster "Generated new cluster keys"
2025-08-09T13:25:44.1579015Z ./ainux-builder.sh:    "cluster_key_fingerprint": "$(ssh-keygen -lf /etc/cluster/cluster.key.pub | awk '{print $2}')"
2025-08-09T13:25:44.1579717Z ./ainux-builder.sh:    log_cluster "Cluster key fingerprint: $(ssh-keygen -lf /etc/cluster/cluster.key.pub | awk '{print $2}')"
2025-08-09T13:25:44.1580301Z ./ainux-builder.sh:            if ssh-keyscan -t ed25519 "$main_ip" >/dev/null 2>&1; then
2025-08-09T13:25:44.1582047Z ./ainux-builder.sh:        if [[ ! -f /etc/cluster/node.key ]]; then
2025-08-09T13:25:44.1582602Z ./ainux-builder.sh:            ssh-keygen -t ed25519 -f /etc/cluster/node.key -N "" -C "ainux-sub-$(hostname)-$(date +%s)"
2025-08-09T13:25:44.1583268Z ./ainux-builder.sh:    "node_key_fingerprint": "$(ssh-keygen -lf /etc/cluster/node.key.pub | awk '{print $2}')"
2025-08-09T13:25:44.1583889Z ./ainux-builder.sh:        test keystatus gfxmenu regexp probe efi_gop efi_uga all_video gfxterm font \
2025-08-09T13:25:44.1584622Z ./build-arm.sh:echo -e "  🔹 Raspberry Pi 400 (keyboard computer)"
2025-08-09T13:25:44.1585079Z ⚠️  Found potential hardcoded secrets above - please review
